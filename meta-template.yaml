mixed-port: 7890
redir-port: 7892
tproxy-port: 7893
allow-lan: true
bind-address: "*"
mode: rule
log-level: info

external-controller: 0.0.0.0:9090
external-ui: ui
secret: ""

ipv6: false
udp: true
unified-delay: true
tcp-concurrent: true

profile:
  store-selected: true
  store-fake-ip: true

dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  nameserver:
    - https://dns.cloudflare.com/dns-query
    - https://dns.google/dns-query
  fallback:
    - tls://1.1.1.1:853
    - tls://8.8.8.8:853
  fallback-filter:
    geoip: true
    geoip-code: CN

# =========================
# 1) èŠ‚ç‚¹è®¢é˜…ï¼ˆProxy Providerï¼‰
# =========================
proxy-providers:
  sub:
    type: http
    url: "YOUR_SUBSCRIPTION_URL_HERE"
    interval: 3600
    path: ./providers/sub.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

# =========================
# 2) è‡ªåŠ¨åˆ†ç±»ï¼ˆæŒ‰èŠ‚ç‚¹åæ­£åˆ™ç­›é€‰ï¼‰
#    ä½ èŠ‚ç‚¹åé‡Œå¸¸è§ï¼šé¦™æ¸¯/æ—¥æœ¬/å°æ¹¾/ç¾å›½/æ–°åŠ å¡ã€HK/JP/TW/US/SG
# =========================
proxy-groups:

  # --- å›½å®¶æµ‹é€Ÿç»„ï¼ˆç¬¬äºŒå±‚ï¼‰ ---
  - name: "ğŸ‡­ğŸ‡° HK"
    type: url-test
    use: [sub]
    filter: "(?i)(é¦™æ¸¯|\\bHK\\b|Hong\\s*Kong)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  - name: "ğŸ‡¯ğŸ‡µ JP"
    type: url-test
    use: [sub]
    filter: "(?i)(æ—¥æœ¬|\\bJP\\b|Japan|Tokyo|Osaka)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  - name: "ğŸ‡¹ğŸ‡¼ TW"
    type: url-test
    use: [sub]
    filter: "(?i)(å°æ¹¾|\\bTW\\b|Taiwan|Taipei|Hinet)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  - name: "ğŸ‡ºğŸ‡¸ US"
    type: url-test
    use: [sub]
    filter: "(?i)(ç¾å›½|\\bUS\\b|United\\s*States|Los\\s*Angeles|San\\s*Jose|Seattle|New\\s*York)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  - name: "ğŸ‡¸ğŸ‡¬ SG"
    type: url-test
    use: [sub]
    filter: "(?i)(æ–°åŠ å¡|\\bSG\\b|Singapore)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  # --- å…œåº•æµ‹é€Ÿ/æ•…éšœè½¬ç§» ---
  - name: "â™»ï¸ Fallback"
    type: fallback
    proxies:
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡¸ US
      - ğŸ‡¹ğŸ‡¼ TW
    url: http://www.gstatic.com/generate_204
    interval: 300

  # =========================
  # 3) åº”ç”¨ç­–ç•¥ç»„ï¼ˆç¬¬ä¸€å±‚ï¼Œç²¾ç»†åˆ†æµå°±é å®ƒï¼‰
  # =========================
  - name: "ğŸŒ Default"
    type: select
    proxies:
      - â™»ï¸ Fallback
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡¸ US
      - ğŸ‡¹ğŸ‡¼ TW
      - DIRECT

  - name: "ğŸ¬ YouTube"
    type: select
    proxies:
      - ğŸ‡¹ğŸ‡¼ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡­ğŸ‡° HK
      - ğŸŒ Default
      - DIRECT

  - name: "ğŸ¤– ChatGPT"
    type: select
    proxies:
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡¸ US
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸŒ Default

  - name: "ğŸ Apple"
    type: select
    proxies:
      - ğŸ‡ºğŸ‡¸ US
      - DIRECT
      - ğŸŒ Default

  - name: "ğŸ§  AI"
    type: select
    proxies:
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡ºğŸ‡¸ US
      - ğŸŒ Default

  - name: "ğŸ“¨ Telegram"
    type: select
    proxies:
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸŒ Default

  - name: "ğŸŸ¦ OKX"
    type: select
    proxies:
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸŒ Default
      - DIRECT

  - name: "ğŸŸ¨ Binance"
    type: select
    proxies:
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸŒ Default
      - DIRECT

  - name: "ğŸŸ¥ Adobe"
    type: select
    proxies:
      - ğŸ‡ºğŸ‡¸ US
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸŒ Default
      - DIRECT

  - name: "ğŸŸª Proton"
    type: select
    proxies:
      - ğŸ‡ºğŸ‡¸ US
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸŒ Default

  # é¢æ¿é‡Œç»™ä½ ä¸€ä¸ªæ€»å¼€å…³ï¼ˆå¯é€‰ï¼‰
  - name: "ğŸš€ PROXY"
    type: select
    proxies:
      - ğŸŒ Default
      - â™»ï¸ Fallback
      - DIRECT


# =========================
# 4) è§„åˆ™é›†ï¼ˆMetaCubeXï¼‰
# =========================
rule-providers:
  youtube:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/youtube.yaml"
    path: ./ruleset/youtube.yaml
    interval: 86400

  openai:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/openai.yaml"
    path: ./ruleset/openai.yaml
    interval: 86400

  apple:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/apple.yaml"
    path: ./ruleset/apple.yaml
    interval: 86400

  telegram:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/telegram.yaml"
    path: ./ruleset/telegram.yaml
    interval: 86400

  binance:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/binance.yaml"
    path: ./ruleset/binance.yaml
    interval: 86400

  okx:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/okx.yaml"
    path: ./ruleset/okx.yaml
    interval: 86400

  adobe:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/adobe.yaml"
    path: ./ruleset/adobe.yaml
    interval: 86400

  # AI ç›¸å…³ï¼ˆé™¤ openai å¤–çš„å¸¸è§ AI/æ¨¡å‹/å¹³å°ï¼‰
  ai:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/ai.yaml"
    path: ./ruleset/ai.yaml
    interval: 86400

  geosite-cn:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/cn.yaml"
    path: ./ruleset/cn.yaml
    interval: 86400

  geoip-cn:
    type: http
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/release/geoip/cn.yaml"
    path: ./ruleset/geoip-cn.yaml
    interval: 86400


# =========================
# 5) è§„åˆ™ï¼ˆé¡ºåºå†³å®šä¸€åˆ‡ï¼ï¼‰
# =========================
rules:
  # --- ç²¾ç»†åˆ†æµï¼ˆæ”¾æœ€å‰ï¼‰ ---
  - RULE-SET,openai,ğŸ¤– ChatGPT
  - RULE-SET,youtube,ğŸ¬ YouTube
  - RULE-SET,apple,ğŸ Apple
  - RULE-SET,ai,ğŸ§  AI
  - RULE-SET,telegram,ğŸ“¨ Telegram
  - RULE-SET,okx,ğŸŸ¦ OKX
  - RULE-SET,binance,ğŸŸ¨ Binance
  - RULE-SET,adobe,ğŸŸ¥ Adobe

  # --- Protonï¼ˆç›®å‰ç”¨è‡ªå®šä¹‰åŸŸåè§„åˆ™ï¼Œå¤Ÿç”¨ä¸”ç¨³å®šï¼‰ ---
  - DOMAIN-SUFFIX,proton.me,ğŸŸª Proton
  - DOMAIN-SUFFIX,protonvpn.com,ğŸŸª Proton
  - DOMAIN-SUFFIX,protonmail.com,ğŸŸª Proton
  - DOMAIN-SUFFIX,pm.me,ğŸŸª Proton
  - DOMAIN-SUFFIX,protonstatus.com,ğŸŸª Proton

  # --- å›½å†…ç›´è¿ï¼ˆé™ä½è¯¯ä¼¤ï¼‰ ---
  - RULE-SET,geosite-cn,DIRECT
  - RULE-SET,geoip-cn,DIRECT
  - GEOIP,CN,DIRECT

  # --- å…œåº• ---
  - MATCH,ğŸŒ Default
